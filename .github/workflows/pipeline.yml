name: Consistency Verification

on: [push, pull_request]

jobs:
  verify:
    runs-on: ubuntu-22.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Install system dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y wget bison flex libgmp-dev libmpfr-dev pkg-config openjdk-11-jdk python3
      
      - name: Download and install K Framework
        run: |
          wget https://github.com/runtimeverification/k/releases/download/v7.1.163/kframework_7.1.163_amd64_jammy.deb
          sudo apt-get install -y ./kframework_7.1.163_amd64_jammy.deb
      
      - name: Install Coq
        run: |
          sudo apt-get install -y coq
      
      - name: Verify installations
        run: |
          kompile --version
          coqc --version
          python3 --version
      
      - name: Run full pipeline
        run: ./run_pipeline.sh
